<!doctype html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Mini Messenger</title>
  <meta name="theme-color" content="#0f172a"/>
  <link rel="manifest" href="/frontend/manifest.webmanifest"/>
  <link rel="apple-touch-icon" href="/frontend/icons/icon-192.svg"/>

    <link rel="stylesheet" href="/frontend/styles.css" />

</head>

<body>
  <div id="systemToasts" class="system-toast-host" aria-live="polite" aria-atomic="true"></div>
  <div id="offlineBanner" class="offline-banner is-hidden" role="status" aria-live="polite">‚ö†Ô∏è –ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç.</div>
  <div class="drawer-backdrop" id="drawerBackdrop" aria-hidden="true"></div>

  <div class="wrap">
    <div class="card">
      <div class="top">
        <div class="top-left">
          <button class="iconbtn" id="btnToggleSidebar" type="button" title="–ú–µ–Ω—é" aria-label="–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é" aria-expanded="false" aria-controls="sidebar">‚ò∞</button>
          <div class="min-0">
            <div class="brand">Mini Messenger</div>
            <div class="small">–£–¥–æ–±–Ω—ã–π —á–∞—Ç –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏ –ü–ö</div>
          </div>
        </div>
        <div class="row top-controls">
          <button class="pill pill-btn" id="whoami" type="button" aria-haspopup="true" aria-expanded="false" aria-controls="profileMenu">
            <img id="topAvatar" class="avatar" alt="avatar"/>
            <span id="whoText">–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω</span>
          </button>
          <button class="btn" id="btnInstallApp" type="button" title="–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ">üì± –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</button>
          <button class="btn" id="btnThemeToggle" type="button" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">üåô –¢–µ–º–∞</button>
          <button class="btn" id="btnOpenAuth" type="button">–í–æ–π—Ç–∏</button>
          <div class="profile-menu" id="profileMenu" aria-hidden="true">
            <button class="profile-menu-item" id="btnMenuMyProfile" type="button">üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</button>
            <button class="profile-menu-item" id="btnMenuContacts" type="button">üìá –ö–æ–Ω—Ç–∞–∫—Ç—ã</button>
            <button class="profile-menu-item" id="btnMenuHelp" type="button">‚ùì –°–ø—Ä–∞–≤–∫–∞</button>
            <button class="profile-menu-item" id="btnMenuLogout" type="button">üö™ –í—ã–π—Ç–∏</button>
          </div>
        </div>
      </div>

      <div class="grid">
        <aside class="sidebar" id="sidebar" aria-hidden="true">
          <div class="sidebar-inner">
            <div class="row row-between">
              <div><b>–ß–∞—Ç—ã</b></div>
              <div class="iconbar">
                <button class="iconbtn" id="btnOpenCreateGroup" type="button" title="–°–æ–∑–¥–∞—Ç—å —á–∞—Ç" aria-label="–°–æ–∑–¥–∞—Ç—å —á–∞—Ç">‚ûï</button>
                <button class="iconbtn" id="btnSidebarMore" type="button" title="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è" aria-label="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è" aria-haspopup="true" aria-expanded="false" aria-controls="sidebarMoreMenu">‚ãØ</button>
                <div class="sidebar-more-menu" id="sidebarMoreMenu" aria-hidden="true">
                  <button class="sidebar-more-item" id="btnRefreshChats" type="button">‚ü≥ –û–±–Ω–æ–≤–∏—Ç—å —á–∞—Ç—ã</button>
                  <button class="sidebar-more-item" id="btnLoadHistory" type="button">üïò –ò—Å—Ç–æ—Ä–∏—è</button>
                  <button class="sidebar-more-item" id="btnContacts" type="button">üìá –ö–æ–Ω—Ç–∞–∫—Ç—ã</button>
                  <button class="sidebar-more-item" id="btnHelp" type="button">‚ùì –°–ø—Ä–∞–≤–∫–∞</button>
                  <button class="sidebar-more-item" id="btnInvite" type="button">‚úâÔ∏è –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å</button>
                  <button class="sidebar-more-item" id="btnMute" type="button">üîï –¢–∏—Ö–∏–π —Ä–µ–∂–∏–º</button>
                </div>
              </div>
            </div>

            <div class="sep"></div>

            <div class="sidebar-search-wrap">
              <input id="chatSearch" class="sidebar-search" type="search" placeholder="–ü–æ–∏—Å–∫" aria-label="–ü–æ–∏—Å–∫ –ø–æ —á–∞—Ç–∞–º" />
              <div class="chat-filters" role="tablist" aria-label="–§–∏–ª—å—Ç—Ä —á–∞—Ç–æ–≤">
                <button class="chat-filter is-active" data-filter="all" type="button">–í—Å–µ</button>
                <button class="chat-filter" data-filter="dm" type="button">–õ–∏—á–Ω—ã–µ</button>
                <button class="chat-filter" data-filter="group" type="button">–ì—Ä—É–ø–ø—ã</button>
              </div>
            </div>

            <div class="chatlist" id="chatlist"></div>
          </div>
        </aside>

        <div class="chat">
          <div class="chat-head">
            <button class="chat-head-info" id="btnChatInfo" type="button">
              <div>
                <div id="chatHeadTitle">–í—ã–±–µ—Ä–∏—Ç–µ —á–∞—Ç</div>
                <div class="small" id="chatHeadSub">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ –º–µ–¥–∏–∞</div>
              </div>
            </button>
            <div class="chat-head-actions" aria-label="–î–µ–π—Å—Ç–≤–∏—è —á–∞—Ç–∞">
              <button class="iconbtn" id="btnStartVoiceCall" type="button" title="–ì–æ–ª–æ—Å–æ–≤–æ–π –∑–≤–æ–Ω–æ–∫" aria-label="–ì–æ–ª–æ—Å–æ–≤–æ–π –∑–≤–æ–Ω–æ–∫">üìû</button>
              <button class="iconbtn" id="btnStartVideoCall" type="button" title="–í–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫" aria-label="–í–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫">üé•</button>
            </div>
          </div>
          <div id="storiesBar" class="stories-bar"></div>
          <div id="pinsBar" class="small pins-bar is-hidden"></div>
          <div class="msgs" id="msgs"></div>
          <div class="to-bottom" id="btnToBottom" title="–í–Ω–∏–∑">‚¨áÔ∏è</div>

          <div class="composer">
            <button id="btnAttach" type="button" title="–§–æ—Ç–æ/–í–∏–¥–µ–æ/–ê—É–¥–∏–æ">üìé</button>
            <input id="file" class="is-hidden" type="file" accept="image/*,video/*,audio/*" />
            <button id="btnRecHold" type="button" title="–£–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –¥–ª—è –∑–∞–ø–∏—Å–∏">üéôÔ∏è</button>
            <div id="replyBox" class="small reply-box is-hidden"></div>
            <input id="text" placeholder="–ù–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ." />
            <button id="btnSend" type="button">‚û§</button>
          </div>

          <div class="statusbar">
            <div class="small">
              <span id="status">‚Äî</span>
              <span class="typing" id="typing"></span>
            </div>
            <div class="pill" id="net">–Ω–µ –≤ —Å–µ—Ç–∏</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- AUTH -->
  <div class="overlay" id="authOverlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true">
      <div class="modal-top">
        <div class="tabs">
          <button class="tab active" id="tabLogin" type="button">–í—Ö–æ–¥</button>
          <button class="tab" id="tabRegister" type="button">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
        </div>
        <button class="xbtn" id="btnCloseAuth" type="button">‚úï</button>
      </div>
      <div class="modal-body">
        <input id="authUsername" placeholder="–ª–æ–≥–∏–Ω (3-20: a-z 0-9 _)" autocomplete="username" />
        <input id="authPassword" placeholder="–ø–∞—Ä–æ–ª—å (–º–∏–Ω 6)" type="password" autocomplete="current-password" />
        <div class="err" id="authError"></div>
        <div class="btnrow"><button id="btnAuthSubmit" type="button">–í—Ö–æ–¥</button></div>
        <div class="small">–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –æ–∫–Ω–æ –∑–∞–∫—Ä–æ–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</div>
      </div>
    </div>
  </div>

  <!-- CREATE SHEET -->
  <div class="sheet-overlay" id="sheetOverlay" aria-hidden="true">
    <div class="sheet" role="dialog" aria-modal="true">
      <div class="sheet-top">
        <b id="sheetTitle">–°–æ–∑–¥–∞—Ç—å</b>
        <button class="xbtn" id="btnCloseSheet" type="button">‚úï</button>
      </div>
      <div class="sheet-body">
        <input id="sheetInput" placeholder="" />
        <div class="sheet-actions">
          <button id="btnSheetOk" type="button">OK</button>
          <button id="btnSheetCancel" type="button" class="danger">–û—Ç–º–µ–Ω–∞</button>
        </div>
        <div class="small hint-muted" id="sheetHint"></div>
      </div>
    </div>
  </div>

  <!-- PROFILE -->
  <div class="sheet-overlay" id="profileOverlay" aria-hidden="true">
    <div class="sheet" role="dialog" aria-modal="true">
      <div class="sheet-top">
        <b>–ü—Ä–æ—Ñ–∏–ª—å</b>
        <button class="xbtn" id="btnCloseProfile" type="button">‚úï</button>
      </div>
      <div class="sheet-body">
        <div class="small">–ò–º—è</div>
        <input id="profileDisplayName" placeholder="–ö–∞–∫ —Ç–µ–±—è –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å" />
        <div class="small">–û —Å–µ–±–µ</div>
        <textarea id="profileBio" placeholder="–ù–µ–º–Ω–æ–≥–æ –æ —Å–µ–±–µ" rows="3"></textarea>
        <button id="btnSaveProfile" class="btn" type="button">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button>
        <div class="sep"></div>
        <div class="small">–ê–≤–∞—Ç–∞—Ä</div>
        <input id="avatarFile" type="file" accept="image/*"/>
        <button id="btnUploadAvatar" class="btn" type="button">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
        <div class="sep"></div>
        <div class="small">–ò—Å—Ç–æ—Ä–∏–∏ (24—á)</div>
        <input id="storyFile" type="file" accept="image/*,video/*"/>
        <input id="storyCaption" placeholder="–ü–æ–¥–ø–∏—Å—å –∫ –∏—Å—Ç–æ—Ä–∏–∏" maxlength="160"/>
        <button id="btnUploadStory" class="btn" type="button">–í—ã–ª–æ–∂–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é</button>
        <div id="myStories" class="small"></div>
        <div class="small" id="profileHint">‚Äî</div>
      </div>
    </div>
  </div>



  <!-- CONTACTS -->
  <div class="sheet-overlay" id="contactsOverlay" aria-hidden="true">
    <div class="sheet" role="dialog" aria-modal="true">
      <div class="sheet-top">
        <b>–ö–æ–Ω—Ç–∞–∫—Ç—ã</b>
        <button class="xbtn" id="btnCloseContacts" type="button">‚úï</button>
      </div>
      <div class="sheet-body">
        <div class="row">
          <input id="contactUsername" placeholder="username" />
          <button class="btn" id="btnAddContact" type="button">–î–æ–±–∞–≤–∏—Ç—å</button>
        </div>
        <div id="contactsList" class="chatlist"></div>
      </div>
    </div>
  </div>

  <!-- CHAT INFO -->
  <div class="sheet-overlay" id="chatInfoOverlay" aria-hidden="true">
    <div class="sheet" role="dialog" aria-modal="true">
      <div class="sheet-top">
        <b id="chatInfoTitle">–ò–Ω—Ñ–æ —á–∞—Ç–∞</b>
        <button class="xbtn" id="btnCloseChatInfo" type="button">‚úï</button>
      </div>
      <div class="sheet-body">
        <input id="chatInfoSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É" />
        <button id="btnChatInfoSearch" class="btn" type="button">–ü–æ–∏—Å–∫</button>
        <div id="chatInfoResults" class="small"></div>
        <div class="sep"></div>

        <div class="chat-info-tabs" role="tablist" aria-label="–ö–∞—Ç–µ–≥–æ—Ä–∏–∏">
          <button class="chat-info-tab active" id="chatInfoTabMedia" data-tab="media" type="button" role="tab" aria-selected="true">–ú–µ–¥–∏–∞</button>
          <button class="chat-info-tab" id="chatInfoTabFiles" data-tab="files" type="button" role="tab" aria-selected="false">–§–∞–π–ª—ã</button>
          <button class="chat-info-tab" id="chatInfoTabVoice" data-tab="voice" type="button" role="tab" aria-selected="false">–ì–æ–ª–æ—Å–æ–≤—ã–µ</button>
          <button class="chat-info-tab" id="chatInfoTabLinks" data-tab="links" type="button" role="tab" aria-selected="false">–°—Å—ã–ª–∫–∏</button>
        </div>

        <div class="chat-info-list" id="chatInfoTabList"></div>
      </div>
    </div>
  </div>

  <!-- HELP -->
  <div class="sheet-overlay" id="helpOverlay" aria-hidden="true">
    <div class="sheet" role="dialog" aria-modal="true">
      <div class="sheet-top">
        <b>–°–ø—Ä–∞–≤–∫–∞</b>
        <button class="xbtn" id="btnCloseHelp" type="button">‚úï</button>
      </div>
      <div class="sheet-body">
        <div class="help-list">
          <div class="help-item"><b>–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é —Å–æ–æ–±—â–µ–Ω–∏–π:</b> –Ω–∞ –ü–ö ‚Äî –ü–ö–ú –ø–æ —Å–æ–æ–±—â–µ–Ω–∏—é, –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ ‚Äî –¥–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ.</div>
          <div class="help-item"><b>–ë—ã—Å—Ç—Ä—ã–π –æ—Ç–≤–µ—Ç:</b> –æ—Ç–∫—Ä–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –≤—ã–±–µ—Ä–∏ ¬´–û—Ç–≤–µ—Ç–∏—Ç—å¬ª.</div>
          <div class="help-item"><b>–ì–æ—Ä—è—á–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ Enter:</b> Enter –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ, Shift+Enter ‚Äî –Ω–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞.</div>
          <div class="help-item"><b>Esc:</b> –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã–µ –º–µ–Ω—é/–º–æ–¥–∞–ª–∫–∏.</div>
          <div class="help-item"><b>–ì–æ–ª–æ—Å–æ–≤–æ–µ:</b> —É–¥–µ—Ä–∂–∏–≤–∞–π –∫–Ω–æ–ø–∫—É üé§, —á—Ç–æ–±—ã –∑–∞–ø–∏—Å–∞—Ç—å, –æ—Ç–ø—É—Å—Ç–∏ ‚Äî –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä.</div>
        </div>
      </div>
    </div>
  </div>



  <!-- USER PROFILE -->
  <div class="sheet-overlay" id="userProfileOverlay" aria-hidden="true">
    <div class="sheet" role="dialog" aria-modal="true">
      <div class="sheet-top">
        <b id="userProfileTitle">–ü—Ä–æ—Ñ–∏–ª—å</b>
        <button class="xbtn" id="btnCloseUserProfile" type="button">‚úï</button>
      </div>
      <div class="sheet-body">
        <img id="userProfileAvatar" class="avatar-large" alt="avatar" style="display:none;"/>
        <div class="small" id="userProfileHandle">@user</div>
        <div class="small" id="userProfileBio">‚Äî</div>
        <div class="sep"></div>
        <b>–ò—Å—Ç–æ—Ä–∏–∏</b>
        <div id="userProfileStories" class="chatlist"></div>
        <div class="sep"></div>
        <b>–ê–≤–∞—Ç–∞—Ä—ã (–Ω–æ–≤—ã–µ –∏ —Å—Ç–∞—Ä—ã–µ)</b>
        <div id="userProfileAvatars" class="chatlist"></div>
      </div>
    </div>
  </div>

  <!-- MEDIA VIEWER -->
  <div class="overlay" id="mediaViewerOverlay" aria-hidden="true">
    <div class="modal media-viewer" role="dialog" aria-modal="true">
      <div class="modal-top">
        <b id="mediaViewerTitle">–ú–µ–¥–∏–∞</b>
        <button class="xbtn" id="btnCloseMediaViewer" type="button">‚úï</button>
      </div>
      <div class="modal-body">
        <div id="mediaViewerContent"></div>
      </div>
    </div>
  </div>

  <!-- VOICE PREVIEW -->
  <div class="overlay" id="voicePreviewOverlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true">
      <div class="modal-top">
        <b>–ì–æ–ª–æ—Å–æ–≤–æ–µ</b>
        <button class="xbtn" id="btnCloseVoicePreview" type="button">‚úï</button>
      </div>
      <div class="modal-body">
        <div id="voicePreviewPlayer"></div>
        <div class="btnrow btnrow-inline">
          <button id="btnSendVoiceNow" class="flex-1" type="button">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
          <button id="btnCancelVoiceNow" type="button" class="danger flex-1">–û—Ç–º–µ–Ω–∞</button>
        </div>
        <div class="small" id="voicePreviewHint">‚Äî</div>
      </div>
    </div>
  </div>

  <!-- CALL PANEL -->
  <div class="overlay" id="callOverlay" aria-hidden="true">
    <div class="modal call-modal" role="dialog" aria-modal="true">
      <div class="modal-top">
        <b id="callTitle">–ó–≤–æ–Ω–æ–∫</b>
        <button class="xbtn" id="btnCloseCall" type="button">‚úï</button>
      </div>
      <div class="modal-body">
        <div class="small" id="callHint">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞‚Ä¶</div>
        <video id="callLocalVideo" class="call-local-video is-hidden" autoplay muted playsinline></video>
        <div class="btnrow btnrow-inline">
          <button id="btnToggleCallMic" class="flex-1" type="button">üéô –ú–∏–∫—Ä–æ—Ñ–æ–Ω</button>
          <button id="btnToggleCallCamera" class="flex-1" type="button">üì∑ –ö–∞–º–µ—Ä–∞</button>
          <button id="btnEndCall" class="danger flex-1" type="button">‚õî –ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
        </div>
      </div>
    </div>
  </div>

  <!-- CONTEXT MENU -->
  <div class="ctx" id="ctxMenu">
    <button id="ctxReply">–û—Ç–≤–µ—Ç–∏—Ç—å</button>
    <button id="ctxPin">üìå –ó–∞–∫—Ä–µ–ø–∏—Ç—å/–æ—Ç–∫—Ä–µ–ø–∏—Ç—å</button>
    <button id="ctxForward">üì® –ü–µ—Ä–µ—Å–ª–∞—Ç—å</button>
    <button id="ctxEdit">–ò–∑–º–µ–Ω–∏—Ç—å</button>
    <button id="ctxDeleteMe">–£–¥–∞–ª–∏—Ç—å —É –º–µ–Ω—è</button>
    <button id="ctxDeleteAll">–£–¥–∞–ª–∏—Ç—å —É –≤—Å–µ—Ö</button>
    <button id="ctxCancel" class="danger">–û—Ç–º–µ–Ω–∞</button>
    <div id="ctxMeta" class="ctx-meta">–î–æ—Å—Ç–∞–≤–∫–∞: ‚Äî<br/>–ü—Ä–æ—á–∏—Ç–∞–Ω–æ: ‚Äî</div>
  </div>

  <script src="/frontend/app.js"></script>

</body>
</html>
